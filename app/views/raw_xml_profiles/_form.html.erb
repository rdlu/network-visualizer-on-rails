<div class="alert alert-warning">
  Os perfis de teste devem ser planejados com cautela antes de qualquer cadastramento ou modificação.<br>
  Eles podem mudar todo o comportamento dos testes!
</div>
<%= form_for([:raw_xml, @profile], :html => {:class => "form-horizontal form-stop"}) do |f| %>
    <div class="row-fluid">
      <div class="span4">
        <div class="control-group">
          <label class="control-label"  for="type_test">Tipo de Teste: </label>
          <div class="controls">
            <%=  select :type_test,'', RawXmlProfilesController.types,{}, :id=>"type_test"  %>
          </div>
        </div>
           <div class="control-group">
              <label class="control-label"  for="name">Nome: </label>
              <div class="controls">
                <%= f.text_field :name  %>
              </div>
           </div>
          <div class="control-group">
            <label class="control-label"  for="type_test">Gerente: </label>
            <div class="controls">
              <%= collection_select :source_probe, :id, Probe.order(:name).all, :id, :pretty_name_with_location, {:include_blank => "Selecione uma sonda de origem..."}, {:class => 'input-block-level'} %>
            </div>
          </div>

        <div class="control-group">
            <label class="control-label"  for="metrics">Métricas: </label>
            <div class="controls">
              <% Metric.all.each do |m| %>
                  <input type="checkbox" name="metrics[]" value="<%= m.plugin %>" /> <%= m.name %> <br/>
              <% end %>
          </div>
        </div>
      </div>
      <div class="span4">
      <div class="control-group">
        <label class="control-label"  for="timeout">Tempo de Expiração: </label>
        <div class="controls">
          <%= f.text_field :timeout %>
        </div>
      </div>

      <div class="control-group">
        <label class="control-label"  for="probe_size">Tamanho da Probe: </label>
        <div class="controls">
          <%= f.text_field :probe_size %>
        </div>
      </div>


      <div class="control-group">
        <label class="control-label"  for="Protocol">Protocolo: </label>
        <div class="controls">
          <select  name = "protocol[]"  id="protocol" onchange=" displayTypes(this.value)" >
            <option name="protocol[]" value="tcp">TCP</option>
            <option name="protocol[]" value="udp">UDP</option>
          </select>
        </div>
      </div>

      </div>
      <div id="opt_tcp" class="span4">
        <div class="control-group">
          <label class="control-label"  for="train_count">Conexões Simultâneas: </label>
          <div class="controls">
            <%= f.text_field :train_count %>
          </div>
        </div>

        <div class="control-group" style="display: none">
          <label class="control-label"  for="train_len">Número do Trens: </label>
          <div class="controls">
            <%= f.text_field :train_len %>
          </div>
        </div>

        <div class="control-group">
          <label class="control-label"  for="mode">Modo de Medição: </label>
          <div class="controls">
            <select  name = "mode[]"  id="mode" onchange="" >
              <option name="mode" value="normal">Normal</option>
              <option name="mode" value="time">Tempo</option>
              <option name="mode" value="mixed">Misto</option>
            </select>
          </div>
        </div>

        <div class="control-group">
          <label class="control-label"  for="time">Tempo de Medição: </label>
          <div class="controls">
            <%= f.text_field :time,:include_blank => "Segundos" %>
          </div>
        </div>

    </div>
      <div class="row-fluid">
        <div class="span12">
          <div class="control-group">
            <div class="controls">
              <%= f.submit "Salvar", :class => "btn btn-primary btn-large" %>
            </div>
          </div>
        </div>
      </div>
    </div>
<% end %>

<script>
    function displayTypes(id)
    {
        if(id == "tcp"){
            $('#opt_tcp').attr('style','display:block');
        }else{
            $('#opt_tcp').attr('style','display:none');
        }

    }
</script>
